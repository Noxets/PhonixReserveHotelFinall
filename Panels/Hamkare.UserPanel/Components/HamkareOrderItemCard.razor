@using Hamkare.Common.Entities.Identity
@using Hamkare.Common.Entities.Orders
@using Hamkare.Component.HamkareComponents
@using Hamkare.Service.Services.Identity
@using Hamkare.Service.Services.Orders
@using Hamkare.Utility.Settings.CoreSettings
@inject OrderItemService OrderItemService

<MudCard Elevation="1" Outlined="true" Class="rounded-lg p-3 mt-3">

    <MudGrid>

        <MudItem xs="12" md="8">

            <MudStack Row="true">

                <MudImage Class="rounded-lg" Width="100" Height="100" Src="@OrderItem.HotelRoom.Images.FirstOrDefault()" ObjectFit="ObjectFit.Contain" ObjectPosition="ObjectPosition.Center"/>

                <MudStack>

                    <MudText Typo="Typo.h6">
                        <b>@OrderItem.HotelRoom.Hotel.Name @OrderItem.HotelRoom.RoomNumber</b>
                    </MudText>

                    <MudStack Row="true" Spacing="3" Class="flex-wrap mt-auto">
                        
                    </MudStack>

                </MudStack>

            </MudStack>

        </MudItem>

        <MudItem xs="12" md="4">

            <MudStack Row="true" Reverse="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.End"
                      Class="w-100 h-100 flex-md-column" Spacing="1">

                <MudStack Spacing="1">

                    @if (OrderItem.Discount != 0)
                    {
                        <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                            <MudText Color="Color.Error">
                                <b>@OrderItem.Discount</b>
                            </MudText>
                            <MudText Typo="Typo.caption" Color="Color.Error">تومان</MudText>
                        </MudStack>
                    }

                    <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                        <MudText Typo="Typo.h6">
                            <b>@OrderItem.Price</b>
                        </MudText>
                        <MudText Typo="Typo.caption">تومان</MudText>
                    </MudStack>

                </MudStack>

                <MudStack Row="true" Class="mt-auto">
                   
                    <HamkareDatePicker OnRender="false" Label="Date" @bind-Date="OrderItem.StartDateTime"/>
                    <HamkareDatePicker OnRender="false" Label="Date" @bind-Date="OrderItem.EndDateTime"/>
                </MudStack>

            </MudStack>

        </MudItem>
    </MudGrid>
</MudCard>

@code{

    [Parameter] public OrderItem OrderItem { get; set; }

    [Parameter] public User User { get; set; }

    [Parameter] public EventCallback OnOrderItemChanged { get; set; }

    private bool InProgress { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
    }

    private async Task Increase(CancellationToken cancellationToken = default)
    {
        await OrderItemService.AddOrUpdateAsync(OrderItem, cancellationToken);

        await OnOrderItemChanged.InvokeAsync();
    }

    private async Task Decrease(CancellationToken cancellationToken = default)
    {
        await OnOrderItemChanged.InvokeAsync();
    }

    private Task FavoriteToggle()
    {
        throw new NotImplementedException();
    }

    private bool GetFavorite()
    {
        throw new NotImplementedException();
    }

}